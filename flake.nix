{
  description = "Networks client setups";
  outputs =
    { self, nixpkgs }:
    let
      gen = lib:
        ''
          echo '${builtins.toJSON lib}' | jq . --sort-keys > networks.autogenerated.json          
          git add .
          git commit --message "Update networks client setup"
          git push
        '';
    in
    rec {
      packages.x86_64-linux.default = nixpkgs.legacyPackages.x86_64-linux.writeShellScriptBin "default" (gen lib);
      packages.x86_64-darwin.default = nixpkgs.legacyPackages.x86_64-darwin.writeShellScriptBin "default" (gen lib);
      packages.aarch64-linux.default = nixpkgs.legacyPackages.aarch64-linux.writeShellScriptBin "default" (gen lib);
      packages.aarch64-darwin.default = nixpkgs.legacyPackages.aarch64-darwin.writeShellScriptBin "default" (gen lib);
      overlays.default = final: prev: {
        networksLib = lib;
      };
      lib = import ./networks;
    };
}
